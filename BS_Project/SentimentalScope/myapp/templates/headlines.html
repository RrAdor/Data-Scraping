{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Select articles for sentiment analysis with SentimentScope"
    />
    <meta name="theme-color" content="#4361ee" />
    <title>Select Article | SentimentScope</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="{% static 'styles/headlines.css' %}" />
  </head>
  <body>
    <!-- Navigation -->
    <nav role="navigation" aria-label="Main navigation">
      <div class="logo">
        <i class="fas fa-chart-line" aria-hidden="true"></i>
        <span>SentimentScope</span>
      </div>
      <div class="nav-links">
        <a href="{% url 'index' %}">Home</a>
        <a href="{% url 'url_analysis' %}" aria-current="page">Analyze</a>
        <a href="{% url 'index' %}#about">About</a>
        <a href="{% url 'index' %}#team">Team</a>
        <a href="{% url 'index' %}#contact">Contact</a>
      </div>
      <div class="user-info">
        <span class="welcome-text">{{ user.full_name }}</span>
        <a href="{% url 'profile' %}" class="nav-btn">
          <i class="fas fa-user"></i> Profile
        </a>
        <a href="{% url 'logout' %}" class="nav-btn logout-btn">
          <i class="fas fa-sign-out-alt"></i> Logout
        </a>
      </div>
    </nav>

    <!-- Main Container -->
    <div class="container">
      {% if messages %}
      <div class="messages">
        {% for message in messages %}
        <div class="message message-{{ message.tags }}">
          <i class="fas fa-info-circle"></i>
          {{ message }}
        </div>
        {% endfor %}
      </div>
      {% endif %}

      <div class="header-section">
        <h1 class="main-title">
          <i class="fas fa-newspaper"></i>
          Select Article to Analyze
        </h1>
        <p class="subtitle">
          Choose an article from the scraped content for sentiment analysis
        </p>
      </div>

        <div class="headlines-section">
          <div class="section-header">
            <h2>
              <i class="fas fa-list"></i>
              Available Articles ({{ headlines|length }})
            </h2>
            <a href="{% url 'url_analysis' %}" class="btn btn-secondary">
              <i class="fas fa-plus"></i>
              Scrape New URL
            </a>
          </div>

          <div class="headlines-grid">
            {% for headline in headlines %}
            <div class="headline-card" data-id="{{ headline.id }}">
              <div class="card-header">
                <div class="content-type">
                  {% if headline.content_type == 'youtube' %}
                  <i class="fab fa-youtube"></i>
                  <span>YouTube Video</span>
                  {% elif headline.content_type == 'article' %}
                  <i class="fas fa-newspaper"></i>
                  <span>Article</span>
                  {% else %}
                  <i class="fas fa-globe"></i>
                  <span>News Portal</span>
                  {% endif %}
                </div>
                <div class="scraped-time">
                  <i class="fas fa-clock"></i>
                  <span>{{ headline.scraped_at|date:"M d, H:i" }}</span>
                </div>
              </div>

              <div class="card-content">
                <h3 class="headline-title">{{ headline.headline }}</h3>

                {% if headline.source_url %}
                <div class="source-url">
                  <i class="fas fa-link"></i>
                  <a
                    href="{{ headline.source_url }}"
                    target="_blank"
                    class="url-link"
                  >
                    {{ headline.source_url|truncatechars:60 }}
                  </a>
                </div>
                {% endif %}
              </div>

              <div class="card-actions">
                <button
                  class="btn btn-primary analyze-btn"
                  data-id="{{ headline.id }}"
                >
                  <i class="fas fa-chart-line"></i>
                  <span class="btn-text">Analyze Content</span>
                  <span class="loading-text" style="display: none">
                    <i class="fas fa-spinner fa-spin"></i>
                    Loading...
                  </span>
                </button>
              </div>
            </div>
            {% empty %}
            <div class="empty-state">
              <i class="fas fa-inbox"></i>
              <h3>No headlines found</h3>
              <p>Please scrape a URL first to see available articles.</p>
              <a href="{% url 'url_analysis' %}" class="btn btn-primary">
                <i class="fas fa-link"></i>
                Scrape URL
              </a>
            </div>
            {% endfor %}
          </div>
        </div>

        <div class="actions-section">
          <a href="{% url 'url_analysis' %}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i>
            Back to URL Input
          </a>
          <button id="clear-all" class="btn btn-outline btn-danger">
            <i class="fas fa-trash"></i>
            Clear All Headlines
          </button>
        </div>
      </div>
    </div>

    <script src="{% static 'js/headlines.js' %}"></script>
  </body>
</html>
